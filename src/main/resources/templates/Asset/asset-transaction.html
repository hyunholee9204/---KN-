<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>거래 내역 조회</title>
    <link rel="stylesheet" href="/css/a/a-transaction.css">
</head>
<body>

<!-- 상단 바 -->
<div class="header">
    <div class="header-left" onclick="goToMain()">KN금융</div>
    <div class="nav-wrapper">
        <div class="nav-menu">
            <a href="/asset">자산 관리</a>
            <a href="/loans">대출 관리</a>
            <a href="/target">목표 달성 트래킹</a>
            <a href="/education/guide">교육 및 정보</a>
            <a href="/notice">공지사항</a>
            <a href="/inquiry">고객센터</a>
        </div>
    </div>
</div>

<!-- 메인 컨텐츠 -->
<div class="container">
    <div class="sidebar">
        <button onclick="location.href='/asset/status'">자산 현황</button>
        <button class="active" onclick="location.href='/asset/transaction/all'">자산 내역 조회</button>
        <button onclick="location.href='/asset/history'">월별 변동 내역</button>
        <button onclick="location.href='/asset/goal'">목표 달성용 자산 등록</button>
    </div>

    <div class="content">
        <h2>📊 자산 수정 내역</h2>

        <!-- 거래 테이블 -->
        <div class="transaction-table" th:if="${transactions != null and !transactions.isEmpty()}">
            <table>
                <thead>
                <tr>
                    <th>번호</th>
                    <th>날짜</th>
                    <th>자산 종류</th>
                    <th>행위</th>
                    <th>금액</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="tx, stat : ${transactions}">
                    <td th:text="${stat.count + (currentPage * 20)}"></td>
                    <td th:text="${#temporals.format(tx.timestamp, 'yyyy-MM-dd HH:mm')}"></td>
                    <td th:text="${tx.type}"></td>
                    <td th:text="${tx.action}"></td>
                    <td th:text="${#numbers.formatInteger(tx.amount, 3, 'COMMA')} + '원'"></td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- 거래 내역 없을 때 -->
        <div th:if="${transactions == null or transactions.isEmpty()}">
            <p>거래 내역이 없습니다.</p>
        </div>

        <!-- ✅ 페이지네이션 -->
        <div class="pagination" th:if="${totalPages > 1}">
            <a th:if="${currentPage > 0}"
               th:href="@{/asset/transaction(page=${currentPage - 1})}">&lt;</a>

            <span th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
                <a th:href="@{/asset/transaction(page=${i})}"
                   th:text="${i + 1}"
                   th:classappend="${i == currentPage} ? 'active' : ''"></a>
            </span>

            <a th:if="${currentPage + 1 < totalPages}"
               th:href="@{/asset/transaction(page=${currentPage + 1})}">&gt;</a>
        </div>

    </div>
</div>

<script>
    function goToMain() {
        window.location.href = "/main";
    }
</script>

</body>
</html>
